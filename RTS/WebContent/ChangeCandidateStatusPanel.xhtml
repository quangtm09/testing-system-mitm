<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">
	<script>
		function toggleJoinDateField() {
			if(jQuery('[id$=\'statusSelect\']').val()=="JOINED") {
				jQuery("#joinDateField").show();
			} else {
				jQuery("#joinDateField").hide();
			}
		}	
	</script>
	
	<rich:modalPanel id="changeCandidateStatusModelPanel" autosized="true"
			onmaskclick="Richfaces.hideModalPanel('changeCandidateStatusModelPanel');">			
		<f:facet name="header">
			<h:outputText value="#{resource['change.status']}" />
		</f:facet>
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage value="/img/close.png" id="closeButton"
					style="margin: 0px; cursor:pointer;" title="#{messages['Button.Close']}"/>					
				<rich:componentControl for="changeCandidateStatusModelPanel"
					attachTo="closeButton" operation="hide" event="onclick"
					sortOrder="ASCENDING"/>
			</h:panelGroup>
		</f:facet> 	
		
		<a:form id="changeStatusForm">		
			<a:outputPanel id="addMessage">
				<h:messages globalOnly="true" styleClass="message"
					errorClass="errormsg" infoClass="infomsg" warnClass="warnmsg" />
			</a:outputPanel>
			<s:div id="changeStatusContent" styleClass="resetPanelPosition">
			
					
				<s:decorate template="/layout/display.xhtml">
					<ui:define name="label">
						<h:outputLabel value="#{messages['com.bosch.ui.currentstatus']}: " />					
					</ui:define>
					<h:outputText value="#{candidateHome.instance.cddStatus}" />
				</s:decorate>			
						
				<s:decorate template="/layout/edit.xhtml">
					<ui:define name="label">
						<h:outputLabel value="#{messages['candidate.new.status']}:" />
					</ui:define>
					<h:selectOneMenu value="#{candidateBussinessBean.candidateStatus}"
						required="true" 
						requiredMessage="#{messages['error.select.required']} #{' '} #{messages['candidate.new.status']}"
						id="statusSelect" 
						onchange="toggleJoinDateField()">
						<s:selectItems
							value="#{candidateStatusHelper.getNextStatuses(candidateHome.instance.cddStatus)}"
							var="item"  
							label="#{item.toString()}"
							itemValue="#{item}"
							noSelectionLabel="#{messages['selectOptions']}">
						</s:selectItems>
						<s:convertEnum/>
					</h:selectOneMenu>
				</s:decorate>
				<div id="joinDateField" style="display: none;">
					<s:decorate template="/layout/edit.xhtml" id="joindatefield">
						<ui:define name="label">
							<h:outputLabel value="#{messages['com.bosch.ui.joindate']}:" />
						</ui:define>
						<rich:calendar value="#{candidateBussinessBean.joinDate}"
							datePattern="#{messages['calendar.pattern']}" 
							enableManualInput="false"
							monthLabels="#{messages['calendar.month.labels']}"
							locale="#{calendarBean.locale}"
							required="true"
							requiredMessage="#{messages['error.select.required']} #{' '} #{messages['com.bosch.ui.joindate']}"/>
					</s:decorate>
				</div>
				<s:decorate template="/layout/edit.xhtml"
					id="statusDescriptionField">
					<ui:define name="label">
						<h:outputLabel value="#{messages['com.bosch.ui.description']}:" />
					</ui:define>
					<h:inputTextarea 
						cols="40" 
						rows="2"
						required="true"
						requiredMessage="#{messages['error.enter.required']} #{' '} #{messages['com.bosch.ui.description']}"
						value="#{candidateHome.instance.cddSkillDescription}">
					</h:inputTextarea>						
				</s:decorate>	
				
				<div style="clear: both">
					<span><rich:spacer height="5" /></span>
				</div>						
		
				<div class="actionButtons" style="clear: both;">
					<a:commandButton value="#{messages['Button.Change']}"
						action="#{candidateBussinessBean.changeCandidateStatus()}"
						reRender="changeStatusForm,cddStatusField,cddDescriptField,cddStatus,addMessage"
						styleClass="submitStandard" 
						limitToList="true"
						ignoreDupResponses="true"
						onclick="Richfaces.showModalPanel('ajaxLoadingModalBox',{width:50, top:200});"
						oncomplete="Richfaces.hideModalPanel('ajaxLoadingModalBox');">
					</a:commandButton>
					<s:button value="#{messages['Button.Cancel']}" 
						type="button"
						onclick="#{rich:component('changeCandidateStatusModelPanel')}.hide();return false;"
						styleClass="submitStandard">
					</s:button>
				</div>
			
			</s:div>	
		
		</a:form>
		
	</rich:modalPanel>	
</ui:composition>